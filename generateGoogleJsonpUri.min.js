// < URI generator plugin for New Google Spreadsheet >
//
// This is a jQuery plugin.
// Tested with jQuery 1.11.1 and 2.1.1
// Tested on IE8 and Chrome 35
//
// Developed by mecrazy - http://mecrazy.net
//
(function(d){d.genJsonpGDU=function(e){function r(){var b=d("html"),c="gen-jsonp-gdu-"+n;b.hasClass(c)&&!a.cache&&b.removeClass(c);if(!b.hasClass(c)&&a.cache){b.addClass(c);var b=a.cacheInterval.sec,b=b+60*a.cacheInterval.min,b=b+3600*a.cacheInterval.hour,g=h.url({minCol:1,maxCol:1,minRow:1,maxRow:1,withoutcallback:!0});p(b,function(){h.ajax({url:g,success:function(b){for(var a=!1,c=0;c<k.time.length;c++)k.time[c]!=b.feed.updated.$t&&(a=!0,c=k.time.length);a&&(k={url:[],json:[],time:[]})}})})}}function s(b,c){var g={url:h.url({minRow:a.pager.startRow,minCol:a.pager.minCol,maxCol:a.pager.minCol,withoutcallback:!0}),async:!1,dataType:"jsonp",callback:"callback",error:function(b,c,a){f.console.log(b,c,a)},success:function(b){a.pager.allRecs=b.feed.entry.length;a.pager.maxPage=Math.floor(a.pager.allRecs/a.pager.recsPerPage);a.pager.allRecs/a.pager.recsPerPage>a.pager.maxPage&&a.pager.maxPage++;a.pager.prev=1<a.pager.page;a.pager.next=a.pager.page<a.pager.maxPage},complete:function(){"object"==typeof b&&q(b,c)}};"object"==typeof b&&"undefined"!=typeof b.beforeSend&&(g.beforeSend=b.beforeSend,b.beforeSend=null);d.ajax(g);return!0}function q(b,c){if(a.cache){var g=k.url.indexOf(b.url);if(0<=g&&!c)b.success(k.json[g]);else{var e=b.success;b.success=function(c){k.url.push(b.url);k.json.push(c);k.time.push(c.feed.updated.$t);e(c)};d.ajax(b)}}else d.ajax(b)}function p(b,c){setTimeout(function(){a.cache&&(c(),p(b,c))},1E3*b)}var f={console:{log:null},errMsg:[]};"undefined"!=typeof console?f.console=console:f.console.log=function(b){5<=f.errMsg.length&&f.errMsg.splice(4,1);f.errMsg.unshift(b)};var n="";"string"==typeof e?n=e:"object"==typeof e&&"string"==typeof e.key&&(n=e.key);var a={key:n,base1:"https://spreadsheets.google.com/feeds/cells/",base2:"/1/public/basic?alt=json-in-script",pager:{enabled:!1,page:1,maxPage:1,prev:!1,next:!1,recsPerPage:5,allRecs:1,startRow:2,minCol:1,maxCol:1},cache:!1,cacheInterval:{sec:0,min:20,hour:0},firstRequest:!0},k={url:[],json:[],time:[]},h={url:function(b){var c=a.base1+a.key+a.base2;"undefined"==typeof b?c+="&callback=callback":("undefined"!=typeof b.minCol&&(c+="&min-col="+b.minCol),"undefined"!=typeof b.maxCol&&(c+="&max-col="+b.maxCol),"undefined"!=typeof b.minRow&&(c+="&min-row="+b.minRow),"undefined"!=typeof b.maxRow&&(c+="&max-row="+b.maxRow),"string"==typeof b.callback?c+="&callback="+b.callback:"undefined"==typeof b.withoutcallback&&(c+="&callback=callback"));return c},set:function(b){var c=a.cache;a=d.extend(!0,a,b);c!=a.cache&&r();return!0},get:function(){return d.extend(!0,{},a)},pageUrl:function(b,c){1>b?b=1:b>a.pager.maxPage&&(b=a.pager.maxPage);var g=b,e=c,d="";a.pager.enabled?(d=a.pager.startRow,d+=(g-1)*a.pager.recsPerPage,d=h.url({minRow:d,maxRow:d+a.pager.recsPerPage-1,minCol:a.pager.minCol,maxCol:a.pager.maxCol,withoutcallback:!0}),"boolean"!=typeof e&&(e=!0),e&&(a.pager.page=g),a.pager.prev=1<a.pager.page,a.pager.next=a.pager.page<a.pager.maxPage):f.console.log('Pager function is not enabled. Use "pager" function to enable it.');return d},pager:function(b){a.pager=d.extend(a.pager,b);a.pager.enabled="undefined"!=typeof b.startRow&&"undefined"!=typeof b.minCol&&"undefined"!=typeof b.maxCol;return a},ajax:function(b,c){"undefined"==typeof c&&(c=!1);var g=d.extend(!0,{url:h.pageUrl(1,!1),dataType:"jsonp",callback:"callback"},b);a.firstRequest?s(g,c):q(g,c);a.firstRequest=!1},jsonToArr:function(b){var c,a,d,e,f=[],l="undefined"!=typeof b.feed.entry;l&&(l=0<b.feed.entry.length);if(l)for(l=0;l<b.feed.entry.length;l++){var k=b.feed.entry[l].content.$t;c=b.feed.entry[l].title.$t;var m=c.match(/[a-z]+/ig);a=[];1<m.length?a=m.split(""):a.push(m);for(var m=0,h=a.length-1;0<=h;h--)m+=(a[h]+"A").charCodeAt(0)-64+26*h;a=c.match(/[0-9]+/ig);c=m;a=Number(a);0===l&&(d=a);0===l&&(e=c);a-=d;for(c-=e;f.length<a+1;)f.push([]);for(;f[a].length<=c;)f[a].push("");f[a][c]=k}return f},showErr:function(){var b="";if(0<f.errMsg.length)for(var a=0;a<f.errMsg.length;a++)b+=f.errMsg[a]+"\r\n\r\n";else b="No error.";alert(b)}};return h}})(jQuery);Array.indexOf||(Array.prototype.indexOf=function(d){for(var e=0;e<this.length;e++)if(this[e]===d)return e;return-1});