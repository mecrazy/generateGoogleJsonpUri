(function(k){k.genJsonpGDU=function(e){function q(a,d){var h={url:n.url({minRow:b.pager.startRow,minCol:b.pager.minCol,maxCol:b.pager.minCol,withoutcallback:!0}),async:!1,dataType:"jsonp",callback:"callback",error:function(a,b,d){l.console.log(a,b,d)},success:function(a){b.pager.allRecs=a.feed.entry.length;b.pager.maxPage=Math.floor(b.pager.allRecs/b.pager.recsPerPage);b.pager.allRecs/b.pager.recsPerPage>b.pager.maxPage&&b.pager.maxPage++;b.pager.prev=1<b.pager.page;b.pager.next=b.pager.page<b.pager.maxPage},complete:function(){"object"==typeof a&&p(a,d)}};"object"==typeof a&&"undefined"!=typeof a.beforeSend&&(h.beforeSend=a.beforeSend,a.beforeSend=null);k.ajax(h);return!0}function p(a,d){if(b.cache){var h=m.url.indexOf(a.url);if(0<=h&&!d)a.success(m.json[h]);else{var f=a.success;a.success=function(b){m.url.push(a.url);m.json.push(b);m.time.push(b.feed.updated.$t);f(b)};k.ajax(a)}}else k.ajax(a)}function r(a,b){setTimeout(function(){b()},1E3*a)}var l={console:{log:null},errMsg:[]};"undefined"!=typeof console?l.console=console:l.console.log=function(a){5<=l.errMsg.length&&l.errMsg.splice(4,1);l.errMsg.unshift(a)};var c="";"string"==typeof e?c=e:"object"==typeof e&&"string"==typeof e.key&&(c=e.key);var b={key:c,base1:"https://spreadsheets.google.com/feeds/cells/",base2:"/od6/public/values?alt=json-in-script",pager:{enabled:!1,page:1,maxPage:1,prev:!1,next:!1,recsPerPage:5,allRecs:1,startRow:2,minCol:1,maxCol:1},cache:!1,cacheInterval:{sec:0,min:20,hour:0},firstRequest:!0},m={url:[],json:[],time:[]},n={url:function(a){var d=b.base1+b.key+b.base2;"undefined"==typeof a?d+="&callback=callback":("undefined"!=typeof a.minCol&&(d+="&min-col="+a.minCol),"undefined"!=typeof a.maxCol&&(d+="&max-col="+a.maxCol),"undefined"!=typeof a.minRow&&(d+="&min-row="+a.minRow),"undefined"!=typeof a.maxRow&&(d+="&max-row="+a.maxRow),"string"==typeof a.callback?d+="&callback="+a.callback:"undefined"==typeof a.withoutcallback&&(d+="&callback=callback"));return d},set:function(a){b=k.extend(!0,b,a);return!0},get:function(){return k.extend(!0,{},b)},pageUrl:function(a,d){1>a?a=1:a>b.pager.maxPage&&(a=b.pager.maxPage);var h=a,f=d,g="";b.pager.enabled?(g=b.pager.startRow,g+=(h-1)*b.pager.recsPerPage,g=n.url({minRow:g,maxRow:g+b.pager.recsPerPage-1,minCol:b.pager.minCol,maxCol:b.pager.maxCol,withoutcallback:!0}),"boolean"!=typeof f&&(f=!0),f&&(b.pager.page=h),b.pager.prev=1<b.pager.page,b.pager.next=b.pager.page<b.pager.maxPage):l.console.log('Pager function is not enabled. Use "pager" function to enable it.');return g},pager:function(a){b.pager=k.extend(b.pager,a);b.pager.enabled="undefined"!=typeof a.startRow&&"undefined"!=typeof a.minCol&&"undefined"!=typeof a.maxCol;return b},ajax:function(a,d){"undefined"==typeof d&&(d=!1);var h=k.extend(!0,{url:n.pageUrl(1,!1),dataType:"jsonp",callback:"callback"},a);b.firstRequest?q(h,d):p(h,d);b.firstRequest=!1},jsonToArr:function(a){var b,h,f,g,e=[],c="undefined"!=typeof a.feed.entry;c&&(c=0<a.feed.entry.length);if(c)for(c=0;c<a.feed.entry.length;c++){var k=a.feed.entry[c].gs$cell.$t;g=Number(a.feed.entry[c].gs$cell.col);f=Number(a.feed.entry[c].gs$cell.row);0===c&&(b=f);0===c&&(h=g);f-=b;for(g-=h;e.length<f+1;)e.push([]);for(;e[f].length<=g;)e[f].push("");e[f][g]=k}return e},showErr:function(){var a="";if(0<l.errMsg.length)for(var b=0;b<l.errMsg.length;b++)a+=l.errMsg[b]+"\r\n\r\n";else a="No error.";alert(a)}};e=k("html");c="gen-jsonp-gdu-"+c;e.hasClass(c)||(e.addClass(c),c=b.cacheInterval.sec,c+=60*b.cacheInterval.min,c+=3600*b.cacheInterval.hour,r(c,function(){n.ajax({url:tempUrl,success:function(a){for(var b=!1,c=0;c<m.time.length;c++)m.time[c]!=a.feed.updated.$t&&(b=!0,c=m.time.length);b&&(m={url:[],json:[],time:[]})}})}));return n}})(jQuery);Array.indexOf||(Array.prototype.indexOf=function(k){for(var e=0;e<this.length;e++)if(this[e]===k)return e;return-1});